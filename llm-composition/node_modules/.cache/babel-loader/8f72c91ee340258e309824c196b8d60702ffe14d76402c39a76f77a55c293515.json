{"ast":null,"code":"var _jsxFileName = \"/Users/nhuang/Desktop/AIPR/llm-composition/src/components/OverviewFlow/OverviewFlow.js\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useState } from 'react';\nimport ReactFlow, { addEdge, MiniMap, Controls, Background, useNodesState, useEdgesState } from 'reactflow';\n// import useWebSocket from 'react-use-websocket';\nimport { io } from 'socket.io-client';\nimport InitialAsk from './InitialAsk';\nimport Dialog from './Dialog';\nimport { nodes as initialNodes, edges as initialEdges } from './initial-elements';\nimport CustomNode from './CustomNode';\nimport CustomEdge from './CustomEdge';\nimport 'reactflow/dist/style.css';\nimport './overview.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst nodeTypes = {\n  custom: CustomNode\n};\nconst minimapStyle = {\n  height: 120\n};\nconst id_to_name_mapping = {\n  '1': 'Dispatcher',\n  '2': 'Plant Health Bot',\n  '3': 'Production Output Bot',\n  '4': 'Distribution Bot',\n  '5': 'Human Resources Bot'\n};\nconst id_to_color_mapping = {\n  '1': '#ef476f',\n  '2': '#ffd166',\n  '3': '#06d6a0',\n  '4': '#118ab2',\n  '5': '#073b4c'\n};\nconst onInit = reactFlowInstance => console.log('flow loaded:', reactFlowInstance);\nconst OverviewFlow = () => {\n  _s();\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);\n  const [initialAsk, setInitialAsk] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [finished, setFinished] = useState(false);\n  const onConnect = useCallback(params => setEdges(eds => addEdge(params, eds)), []);\n\n  /* Sockets Approach */\n  useEffect(() => {\n    const socket = io('http://localhost:5000');\n    socket.on('addEdge', data => {\n      if (data.type === 'addEdge') {\n        setMessages(prevMessages => [...prevMessages, data.edge]);\n        setEdges([]);\n        setEdges(eds => addEdge(data.edge, eds));\n      }\n    });\n    socket.on('action', data => {\n      if (data.type === 'action') {\n        setMessages(prevMessages => [...prevMessages, data.edge]);\n      }\n    });\n    socket.on('initialAsk', data => {\n      if (data.type === 'initialAsk') {\n        setFinished(false);\n        setInitialAsk(data.ask);\n        setMessages([]);\n      }\n    });\n    socket.on('askFinished', data => {\n      if (data.type === 'askFinished') {\n        setEdges([]);\n        setFinished(true);\n      }\n    });\n    return () => {\n      socket.disconnect();\n    };\n  }, []);\n  const edgeTypes = {\n    \"customEdge\": CustomEdge\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"row\",\n    style: {\n      width: '100vw',\n      height: '100vh'\n    },\n    children: [/*#__PURE__*/_jsxDEV(ReactFlow, {\n      nodes: nodes,\n      edges: edges,\n      edgeTypes: edgeTypes,\n      onNodesChange: onNodesChange,\n      onEdgesChange: onEdgesChange,\n      onConnect: onConnect,\n      onInit: onInit,\n      fitView: true,\n      attributionPosition: \"top-right\",\n      nodeTypes: nodeTypes,\n      style: {\n        width: '50%',\n        height: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(MiniMap, {\n        style: minimapStyle,\n        zoomable: true,\n        pannable: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Controls, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Background, {\n        color: \"#aaa\",\n        gap: 16\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"column\",\n      style: {\n        width: '50%',\n        overflowY: 'auto'\n      },\n      children: [/*#__PURE__*/_jsxDEV(InitialAsk, {\n        ask: initialAsk\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), messages.map((item, index) => /*#__PURE__*/_jsxDEV(Dialog, {\n        source_name: id_to_name_mapping[item.source],\n        source_color: id_to_color_mapping[item.source],\n        target_name: id_to_name_mapping[item.target],\n        target_color: id_to_color_mapping[item.target],\n        message: item.data.label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 13\n      }, this)), finished && /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"finishedBox\",\n        children: \"Finished Successfully!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n};\n_s(OverviewFlow, \"5YPVW0gcz/REQ8kTJ2Mc0B7TUBc=\", false, function () {\n  return [useNodesState, useEdgesState];\n});\n_c = OverviewFlow;\nexport default OverviewFlow;\nvar _c;\n$RefreshReg$(_c, \"OverviewFlow\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","ReactFlow","addEdge","MiniMap","Controls","Background","useNodesState","useEdgesState","io","InitialAsk","Dialog","nodes","initialNodes","edges","initialEdges","CustomNode","CustomEdge","jsxDEV","_jsxDEV","nodeTypes","custom","minimapStyle","height","id_to_name_mapping","id_to_color_mapping","onInit","reactFlowInstance","console","log","OverviewFlow","_s","setNodes","onNodesChange","setEdges","onEdgesChange","initialAsk","setInitialAsk","messages","setMessages","finished","setFinished","onConnect","params","eds","socket","on","data","type","prevMessages","edge","ask","disconnect","edgeTypes","class","style","width","children","fitView","attributionPosition","zoomable","pannable","fileName","_jsxFileName","lineNumber","columnNumber","color","gap","overflowY","map","item","index","source_name","source","source_color","target_name","target","target_color","message","label","_c","$RefreshReg$"],"sources":["/Users/nhuang/Desktop/AIPR/llm-composition/src/components/OverviewFlow/OverviewFlow.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport ReactFlow, {\n  addEdge,\n  MiniMap,\n  Controls,\n  Background,\n  useNodesState,\n  useEdgesState,\n} from 'reactflow';\n// import useWebSocket from 'react-use-websocket';\nimport { io } from 'socket.io-client';\nimport InitialAsk from './InitialAsk';\nimport Dialog from './Dialog';\n\nimport { nodes as initialNodes, edges as initialEdges } from './initial-elements';\nimport CustomNode from './CustomNode';\nimport CustomEdge from './CustomEdge';\n\nimport 'reactflow/dist/style.css';\nimport './overview.css';\n\nconst nodeTypes = {\n  custom: CustomNode,\n};\n\nconst minimapStyle = {\n  height: 120,\n};\n\nconst id_to_name_mapping = {\n  '1': 'Dispatcher',\n  '2': 'Plant Health Bot',\n  '3': 'Production Output Bot',\n  '4': 'Distribution Bot',\n  '5': 'Human Resources Bot'\n}\nconst id_to_color_mapping = {\n  '1': '#ef476f',\n  '2': '#ffd166',\n  '3': '#06d6a0',\n  '4': '#118ab2',\n  '5': '#073b4c'\n}\n\nconst onInit = (reactFlowInstance) => console.log('flow loaded:', reactFlowInstance);\n\nconst OverviewFlow = () => {\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);\n  const [initialAsk, setInitialAsk] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [finished, setFinished] = useState(false);\n  const onConnect = useCallback((params) => setEdges((eds) => addEdge(params, eds)), []);\n\n  /* Sockets Approach */\n  useEffect(() => {\n    const socket = io('http://localhost:5000');\n\n    socket.on('addEdge', (data) => {\n      if (data.type === 'addEdge') {\n        setMessages((prevMessages) => [...prevMessages, data.edge]);\n        setEdges([])\n        setEdges((eds) => addEdge(data.edge, eds));\n      }\n    });\n\n    socket.on('action', (data) => {\n      if (data.type === 'action') {\n        setMessages((prevMessages) => [...prevMessages, data.edge]);\n      }\n    });\n\n    socket.on('initialAsk', (data) => {\n      if (data.type === 'initialAsk') {\n        setFinished(false)\n        setInitialAsk(data.ask)\n        setMessages([])\n      }\n    });\n\n    socket.on('askFinished', (data) => {\n      if (data.type === 'askFinished') {\n        setEdges([])\n        setFinished(true)\n      }\n    });\n\n    return () => {\n      socket.disconnect();\n    };\n  }, []);\n\n  const edgeTypes = {\n    \"customEdge\": CustomEdge,\n  };\n\n  return (\n    <div class=\"row\" style={{ width: '100vw', height: '100vh' }}>\n        <ReactFlow\n          nodes={nodes}\n          edges={edges}\n          edgeTypes={edgeTypes}\n          onNodesChange={onNodesChange}\n          onEdgesChange={onEdgesChange}\n          onConnect={onConnect}\n          onInit={onInit}\n          fitView\n          attributionPosition=\"top-right\"\n          nodeTypes={nodeTypes}\n          style={{ width: '50%', height: '100%' }}\n        >\n          <MiniMap style={minimapStyle} zoomable pannable />\n          <Controls />\n          <Background color=\"#aaa\" gap={16} />\n        </ReactFlow>\n        <div class='column' style={{ width: '50%', overflowY: 'auto'}}>\n          <InitialAsk ask={initialAsk}/>\n          {messages.map((item, index) => (\n            <Dialog\n              source_name={id_to_name_mapping[item.source]}\n              source_color={id_to_color_mapping[item.source]}\n              target_name={id_to_name_mapping[item.target]}\n              target_color={id_to_color_mapping[item.target]}\n              message={item.data.label}\n            />\n          ))}\n          {\n            finished && <div class=\"finishedBox\">\n               Finished Successfully!\n            </div>\n          }    \n        </div>\n    </div>\n  );\n};\n\nexport default OverviewFlow;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}